!function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?e(Object(o),!0).forEach((function(e){n(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=t,this._authKey=n}var n,o;return n=e,o=[{key:"getAllCards",value:function(){return this._sendRequest("GET","/cards").then(this._checkResponse)}},{key:"addCard",value:function(e){var t=e.name,n=e.link;return this._sendRequest("POST","/cards",{body:JSON.stringify({name:t,link:n})}).then(this._checkResponse)}},{key:"deleteCard",value:function(e){return this._sendRequest("DELETE","/cards/"+e).then(this._checkResponse)}},{key:"likeCard",value:function(e){return this._sendRequest("PUT","/cards/likes/"+e).then(this._checkResponse)}},{key:"dislikeCard",value:function(e){return this._sendRequest("DELETE","/cards/likes/"+e).then(this._checkResponse)}},{key:"getUserInfo",value:function(){return this._sendRequest("GET","/users/me").then(this._checkResponse)}},{key:"updateUserInfo",value:function(e){var t=e.name,n=e.about;return this._sendRequest("PATCH","/users/me",{body:JSON.stringify({name:t,about:n})}).then(this._checkResponse)}},{key:"updateUserAvatar",value:function(e){var t=e.avatar;return this._sendRequest("PATCH","/users/me/avatar",{body:JSON.stringify({avatar:t})}).then(this._checkResponse)}},{key:"_sendRequest",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return fetch(this._baseUrl+n,t({method:e,headers:{Authorization:this._authKey,"Content-Type":"application/json"}},r))}},{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("An error occurred: ".concat(e.status," ").concat(e.statusText))}}],o&&r(n.prototype,o),e}(),i=o;function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(){function e(t,n,r,o){var i=t._id,a=t.name,u=t.link,s=t.likes,c=t.owner,f=r.handleImageClick,h=r.handleLikeClick,d=r.handleRemoveClick;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),l(this,"_cardSelector",".card"),l(this,"_titleSelector",".card__title"),l(this,"_imageSelector",".card__image"),l(this,"_likeButtonSelector",".card__like-button"),l(this,"_likeCounterSelector",".card__like-counter"),l(this,"_removeButtonSelector",".card__remove-button"),l(this,"_likeButtonActiveClass","card__like-button_active"),this._id=i,this._name=a,this._link=u,this._likes=s,this._owner=c,this._templateSelector=n,this._handleImageClick=f,this._handleLikeClick=h,this._handleRemoveClick=d,this._userId=o}var t,n;return t=e,n=[{key:"generateElement",value:function(){return this._createFromTemplate(),this._setEventListeners(),this._checkPermissions(),this.updateLikes(),this._titleElement.textContent=this._name,this._imageElement.alt=this._name,this._imageElement.src=this._link,this._cardElement}},{key:"removeElement",value:function(){this._cardElement.remove()}},{key:"updateLikes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.likes;this._likes=t||this._likes,this._isLiked()?this._markLiked():this._markDisliked(),this._likeCounterElement.textContent=this._likes.length}},{key:"_createFromTemplate",value:function(){this._cardElement=document.querySelector(this._templateSelector).content.querySelector(this._cardSelector).cloneNode(!0),this._titleElement=this._cardElement.querySelector(this._titleSelector),this._imageElement=this._cardElement.querySelector(this._imageSelector),this._likeButtonElement=this._cardElement.querySelector(this._likeButtonSelector),this._likeCounterElement=this._cardElement.querySelector(this._likeCounterSelector),this._removeButtonElement=this._cardElement.querySelector(this._removeButtonSelector)}},{key:"_setEventListeners",value:function(){var e=this;this._imageElement.addEventListener("click",this._handleImageClick),this._likeButtonElement.addEventListener("click",(function(){return e._handleLikeClick(e._id,e._isLiked())})),this._removeButtonElement.addEventListener("click",(function(){return e._handleRemoveClick(e._id)}))}},{key:"_checkPermissions",value:function(){this._owner._id!==this._userId&&this._removeButtonElement.remove()}},{key:"_isLiked",value:function(){var e=this;return this._likes.some((function(t){return t._id===e._userId}))}},{key:"_markLiked",value:function(){this._likeButtonElement.classList.add(this._likeButtonActiveClass)}},{key:"_markDisliked",value:function(){this._likeButtonElement.classList.remove(this._likeButtonActiveClass)}}],n&&a(t.prototype,n),e}(),s=u;function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"_backgroundClass","dialogue"),f(this,"_closeButtonClass","dialogue__close-button"),f(this,"_openedClass","dialogue_opened"),this._dialogueElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this),this._handleClickClose=this._handleClickClose.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._dialogueElement.classList.add(this._openedClass),this.setEventListeners()}},{key:"close",value:function(){this._dialogueElement.classList.remove(this._openedClass),this.removeEventListeners()}},{key:"setEventListeners",value:function(){document.addEventListener("keydown",this._handleEscClose),this._dialogueElement.addEventListener("click",this._handleClickClose)}},{key:"removeEventListeners",value:function(){document.removeEventListener("keydown",this._handleEscClose),this._dialogueElement.removeEventListener("click",this._handleClickClose)}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"_handleClickClose",value:function(e){(e.target.classList.contains(this._backgroundClass)||e.target.classList.contains(this._closeButtonClass))&&this.close()}}])&&c(t.prototype,n),e}();function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(){return _="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=p(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},_.apply(this,arguments)}function p(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=k(e)););return e}function y(e,t){return y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},y(e,t)}function v(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e){return k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},k(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=k(r);if(o){var n=k(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return v(this,e)});function a(e){var t,n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),o=".dialogue__submit-button",(r="_buttonSelector")in(n=b(t=i.call(this,e)))?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,t._buttonElement=t._dialogueElement.querySelector(t._buttonSelector),t}return t=a,(n=[{key:"open",value:function(e){this._confirmationCallback=e,_(k(a.prototype),"open",this).call(this)}},{key:"setEventListeners",value:function(){_(k(a.prototype),"setEventListeners",this).call(this),this._buttonElement.addEventListener("click",this._confirmationCallback)}},{key:"removeEventListeners",value:function(){_(k(a.prototype),"removeEventListeners",this).call(this),this._buttonElement.removeEventListener("click",this._confirmationCallback)}}])&&m(t.prototype,n),a}(h);function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(){return O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=w(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},O.apply(this,arguments)}function w(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}function C(e,t){return C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},C(e,t)}function L(e,t){if(t&&("object"===E(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return j(e)}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(r);if(o){var n=P(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return L(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),R(j(n=i.call(this,e)),"_formSelector",".dialogue__form"),R(j(n),"_buttonSelector",".dialogue__submit-button"),n._formElement=n._dialogueElement.querySelector(n._formSelector),n._buttonElement=n._dialogueElement.querySelector(n._buttonSelector),n._submissionCallback=t,n._handleFormSubmission=n._handleFormSubmission.bind(j(n)),n}return t=a,(n=[{key:"close",value:function(){O(P(a.prototype),"close",this).call(this),this._formElement.reset()}},{key:"setInputValues",value:function(e){for(var t in e)this._formElement.elements[t]&&(this._formElement.elements[t].value=e[t])}},{key:"setLoadingState",value:function(e){this._buttonElement.textContent=e?"Saving...":"Save"}},{key:"setEventListeners",value:function(){O(P(a.prototype),"setEventListeners",this).call(this),this._formElement.addEventListener("submit",this._handleFormSubmission)}},{key:"removeEventListeners",value:function(){O(P(a.prototype),"removeEventListeners",this).call(this),this._formElement.removeEventListener("submit",this._handleFormSubmission)}},{key:"_handleFormSubmission",value:function(e){e.preventDefault(),this._submissionCallback(this._getInputValues())}},{key:"_getInputValues",value:function(){return this._formElement.elements}}])&&S(t.prototype,n),a}(h);function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D(){return D="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=x(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},D.apply(this,arguments)}function x(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=F(e)););return e}function U(e,t){return U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},U(e,t)}function A(e,t){if(t&&("object"===B(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return V(e)}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(e){return F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},F(e)}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=F(r);if(o){var n=F(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return A(this,e)});function a(){var e;q(this,a);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return N(V(e=i.call.apply(i,[this].concat(n))),"_imageSelector",".dialogue__image"),N(V(e),"_captionSelector",".dialogue__caption"),e}return t=a,(n=[{key:"open",value:function(e){var t=e.name,n=e.link;D(F(a.prototype),"open",this).call(this);var r=this._dialogueElement.querySelector(this._imageSelector);r.alt=t,r.src=n,this._dialogueElement.querySelector(this._captionSelector).textContent=t}}])&&T(t.prototype,n),a}(h),J=z;function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var H=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._formElement=t,this._validationSettings=n}var t,n;return t=e,(n=[{key:"enableValidation",value:function(){var e=this;this._analyzeForm(),this._toggleSubmitButtonState(),this._inputsList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleSubmitButtonState()}))})),this._formElement.addEventListener("reset",(function(){return e._makeSubmitButtonDisabled()}))}},{key:"_analyzeForm",value:function(){this._inputsList=Array.from(this._formElement.querySelectorAll(this._validationSettings.inputSelector)),this._submitButtonElement=this._formElement.querySelector(this._validationSettings.submitButtonSelector)}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_showInputError",value:function(e,t){var n=this._getInputErrorElement(e);e.classList.add(this._validationSettings.inputErrorClass),n.classList.add(this._validationSettings.errorVisibleClass),n.textContent=t}},{key:"_hideInputError",value:function(e){var t=this._getInputErrorElement(e);e.classList.remove(this._validationSettings.inputErrorClass),t.classList.remove(this._validationSettings.errorVisibleClass),t.textContent=null}},{key:"_getInputErrorElement",value:function(e){var t=this._validationSettings.inputErrorSelector.replace("%formId",this._formElement.id).replace("%inputName",e.name);return this._formElement.querySelector(t)}},{key:"_toggleSubmitButtonState",value:function(){this._hasInvalidInput()?this._makeSubmitButtonDisabled():this._makeSubmitButtonActive()}},{key:"_hasInvalidInput",value:function(){return this._inputsList.some((function(e){return!e.validity.valid}))}},{key:"_makeSubmitButtonActive",value:function(){this._submitButtonElement.classList.remove(this._validationSettings.inactiveButtonClass),this._submitButtonElement.disabled=!1}},{key:"_makeSubmitButtonDisabled",value:function(){this._submitButtonElement.classList.add(this._validationSettings.inactiveButtonClass),this._submitButtonElement.disabled=!0}}])&&G(t.prototype,n),e}(),K=H;function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Q=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._containerElement=document.querySelector(t),this._rendererCallback=n}var t,n;return t=e,(n=[{key:"renderItems",value:function(e){var t=this;e.forEach((function(e){return t._rendererCallback(e)}))}},{key:"addElementFirst",value:function(e){this._containerElement.prepend(e)}},{key:"addElementLast",value:function(e){this._containerElement.append(e)}}])&&M(t.prototype,n),e}();function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var X=function(){function e(t){var n,r=t.nameSelector,o=t.aboutSelector,i=t.avatarSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=void 0,"_id"in this?Object.defineProperty(this,"_id",{value:n,enumerable:!0,configurable:!0,writable:!0}):this._id=n,this._nameElement=document.querySelector(r),this._aboutElement=document.querySelector(o),this._avatarElement=document.querySelector(i)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{id:this._id,name:this._nameElement.textContent,about:this._aboutElement.textContent,avatar:this._avatarElement.src}}},{key:"setUserInfo",value:function(e){var t=e._id,n=e.name,r=e.about,o=e.avatar;this._id=t||this._id,this._nameElement.textContent=n,this._aboutElement.textContent=r,this._avatarElement.src=o}}])&&W(t.prototype,n),e}(),Y="error_visible",Z={formSelector:".dialogue__form",inputSelector:".dialogue__form-field",inputErrorSelector:".%formId-%inputName-error",submitButtonSelector:".dialogue__submit-button",inactiveButtonClass:"dialogue__submit-button_disabled",inputErrorClass:"dialogue__form-field_has-error",errorVisibleClass:"dialogue__form-error_visible"};function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){te(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ne=new i("https://around.nomoreparties.co/v1/group-12","190e9486-cf84-4370-aa42-80831152ad82"),re=new Q(".cards__list",(function(e){return re.addElementLast(fe(e))})),oe=new I(".dialogue_type_card-add",(function(e){oe.setLoadingState(!0),ne.addCard({name:e.title.value,link:e.image.value}).then((function(e){return re.addElementFirst(fe(e))})).catch(ce).finally((function(){oe.close(),oe.setLoadingState(!1)}))})),ie=new g(".dialogue_type_card-remove"),ae=new J(".dialogue_type_card-view"),le=new I(".dialogue_type_profile-change-picture",(function(e){le.setLoadingState(!0),ne.updateUserAvatar({avatar:e.avatar.value}).then((function(e){return se.setUserInfo(e)})).catch(ce).finally((function(){le.close(),le.setLoadingState(!1)}))})),ue=new I(".dialogue_type_profile-edit",(function(e){ue.setLoadingState(!0),ne.updateUserInfo({name:e.name.value,about:e.about.value}).then((function(e){return se.setUserInfo(e)})).catch(ce).finally((function(){ue.close(),ue.setLoadingState(!1)}))})),se=new X({nameSelector:".profile__title-text",aboutSelector:".profile__subtitle",avatarSelector:".profile__avatar-image"}),ce=function(e){var t=document.querySelector(".error");t.textContent=e,t.classList.add(Y),setTimeout((function(){return t.classList.remove(Y)}),5e3),console.error(e)},fe=function(e){var t=new s(e,"#card-template",{handleImageClick:function(){return ae.open(e)},handleLikeClick:function(e,n){n?ne.dislikeCard(e).then((function(e){return t.updateLikes(e)})).catch(ce):ne.likeCard(e).then((function(e){return t.updateLikes(e)})).catch(ce)},handleRemoveClick:function(e){ie.open((function(){ne.deleteCard(e).then((function(){return t.removeElement()})).catch(ce).finally((function(){return ie.close()}))}))}},se.getUserInfo().id);return t.generateElement()};document.querySelector(".profile__add-button").addEventListener("click",(function(){return oe.open()})),document.querySelector(".profile__avatar-overlay").addEventListener("click",(function(){le.setInputValues(se.getUserInfo()),le.open()})),document.querySelector(".profile__edit-button").addEventListener("click",(function(){ue.setInputValues(se.getUserInfo()),ue.open()})),se.setUserInfo(ee(ee({},se.getUserInfo()),{},{name:"Loading..."})),Promise.all([ne.getUserInfo(),ne.getAllCards()]).then((function(e){se.setUserInfo(e[0]),re.renderItems(e[1])})).catch(ce),Array.from(document.querySelectorAll(Z.formSelector)).forEach((function(e){new K(e,Z).enableValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUlxQyxnQkFDNUIzTSxNQUFLLFNBQUFlLEdBQ0Z5SyxHQUFTQyxZQUFZMUssRUFBUyxJQUM5QndKLEdBQWVxQyxZQUFZN0wsRUFBUyxPQUV2Q2tLLE1BQU1DLElBU090RCxNQUFNQyxLQUFLckUsU0FBU3NFLGlCQUFpQlgsRUFBbUJrRCxlQUVoRTdDLFNBQVEsU0FBQU4sR0FDTyxJQUFJRCxFQUFjQyxFQUFhQyxHQUN2QzBGLHNCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvRGlhbG9ndWUuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0RpYWxvZ3VlV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvRGlhbG9ndWVXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvRGlhbG9ndWVXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbGl0aWVzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEFwaSB7XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSBhbiBBcGkgaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYmFzZVVybFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdXRoS2V5XG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGJhc2VVcmwsIGF1dGhLZXkpIHtcbiAgICAgICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgICAgIHRoaXMuX2F1dGhLZXkgPSBhdXRoS2V5O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhbGwgY2FyZHMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZX1cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgZ2V0QWxsQ2FyZHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZW5kUmVxdWVzdCgnR0VUJywgJy9jYXJkcycpLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgbmV3IGNhcmQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsaW5rXG4gICAgICogQHJldHVybnMge1Byb21pc2V9XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGFkZENhcmQoe25hbWUsIGxpbmt9KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZW5kUmVxdWVzdCgnUE9TVCcsICcvY2FyZHMnLCB7XG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7bmFtZSwgbGlua30pXG4gICAgICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVsZXRlIGEgc3BlY2lmaWMgY2FyZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlfVxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBkZWxldGVDYXJkKGlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZW5kUmVxdWVzdCgnREVMRVRFJywgJy9jYXJkcy8nICsgaWQpLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTGlrZSBhIHNwZWNpZmljIGNhcmQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZX1cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgbGlrZUNhcmQoaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NlbmRSZXF1ZXN0KCdQVVQnLCAnL2NhcmRzL2xpa2VzLycgKyBpZCkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEaXNsaWtlIGEgc3BlY2lmaWMgY2FyZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlfVxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBkaXNsaWtlQ2FyZChpZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2VuZFJlcXVlc3QoJ0RFTEVURScsICcvY2FyZHMvbGlrZXMvJyArIGlkKS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB1c2VyJ3MgaW5mb3JtYXRpb24uXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZX1cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgZ2V0VXNlckluZm8oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZW5kUmVxdWVzdCgnR0VUJywgJy91c2Vycy9tZScpLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHVzZXIncyBpbmZvcm1hdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGFib3V0XG4gICAgICogQHJldHVybnMge1Byb21pc2V9XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIHVwZGF0ZVVzZXJJbmZvKHtuYW1lLCBhYm91dH0pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NlbmRSZXF1ZXN0KCdQQVRDSCcsICcvdXNlcnMvbWUnLCB7XG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7bmFtZSwgYWJvdXR9KVxuICAgICAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB1c2VyJ3MgYXZhdGFyLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGF2YXRhclxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlfVxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICB1cGRhdGVVc2VyQXZhdGFyKHthdmF0YXJ9KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZW5kUmVxdWVzdCgnUEFUQ0gnLCAnL3VzZXJzL21lL2F2YXRhcicsIHtcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHthdmF0YXJ9KVxuICAgICAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBzZW5kaW5nIHRoZSByZXF1ZXN0IHRvIHRoZSBzZXJ2ZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbWV0aG9kXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRhcmdldFVybFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gICAgICogQHJldHVybnMge1Byb21pc2V9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2VuZFJlcXVlc3QobWV0aG9kLCB0YXJnZXRVcmwsIG9wdGlvbnMgPSB7fSkge1xuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIHRhcmdldFVybCwge1xuICAgICAgICAgICAgbWV0aG9kLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogdGhpcy5fYXV0aEtleSxcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLi4ub3B0aW9uc1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgY2hlY2tpbmcgdGhlIHJlc3BvbnNlIGZyb20gdGhlIHNlcnZlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UmVzcG9uc2V9IHJlc3BvbnNlXG4gICAgICogQHJldHVybnMge1Byb21pc2V9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfY2hlY2tSZXNwb25zZShyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEFuIGVycm9yIG9jY3VycmVkOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQXBpO1xuIiwiY2xhc3MgQ2FyZCB7XG4gICAgLy8gU2VsZWN0b3JzIGFuZCBjbGFzc2VzXG4gICAgX2NhcmRTZWxlY3RvciA9ICcuY2FyZCc7XG4gICAgX3RpdGxlU2VsZWN0b3IgPSAnLmNhcmRfX3RpdGxlJztcbiAgICBfaW1hZ2VTZWxlY3RvciA9ICcuY2FyZF9faW1hZ2UnO1xuICAgIF9saWtlQnV0dG9uU2VsZWN0b3IgPSAnLmNhcmRfX2xpa2UtYnV0dG9uJztcbiAgICBfbGlrZUNvdW50ZXJTZWxlY3RvciA9ICcuY2FyZF9fbGlrZS1jb3VudGVyJztcbiAgICBfcmVtb3ZlQnV0dG9uU2VsZWN0b3IgPSAnLmNhcmRfX3JlbW92ZS1idXR0b24nO1xuICAgIF9saWtlQnV0dG9uQWN0aXZlQ2xhc3MgPSAnY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlJztcblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemUgYSBjYXJkIGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IF9pZFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGxpbmtcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaWtlc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvd25lclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZW1wbGF0ZVNlbGVjdG9yXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gaGFuZGxlSW1hZ2VDbGlja1xuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZUxpa2VDbGlja1xuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZVJlbW92ZUNsaWNrXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVzZXJJZFxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih7X2lkLCBuYW1lLCBsaW5rLCBsaWtlcywgb3duZXJ9LCB0ZW1wbGF0ZVNlbGVjdG9yLCB7aGFuZGxlSW1hZ2VDbGljaywgaGFuZGxlTGlrZUNsaWNrLCBoYW5kbGVSZW1vdmVDbGlja30sIHVzZXJJZCkge1xuICAgICAgICAvLyBDYXJkJ3MgaW5mb3JtYXRpb25cbiAgICAgICAgdGhpcy5faWQgPSBfaWQ7XG4gICAgICAgIHRoaXMuX25hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLl9saW5rID0gbGluaztcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcbiAgICAgICAgdGhpcy5fb3duZXIgPSBvd25lcjtcblxuICAgICAgICAvLyBDYXJkJ3MgdGVtcGxhdGVcbiAgICAgICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XG5cbiAgICAgICAgLy8gRXZlbnQgaGFuZGxpbmcgY2FsbGJhY2tzXG4gICAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XG4gICAgICAgIHRoaXMuX2hhbmRsZVJlbW92ZUNsaWNrID0gaGFuZGxlUmVtb3ZlQ2xpY2s7XG5cbiAgICAgICAgLy8gVGhlIGlkIG9mIHRoZSBsb2dnZWQtaW4gdXNlclxuICAgICAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGUgYSBjYXJkIGVsZW1lbnQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH1cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgZ2VuZXJhdGVFbGVtZW50KCkge1xuICAgICAgICB0aGlzLl9jcmVhdGVGcm9tVGVtcGxhdGUoKTtcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgICAgdGhpcy5fY2hlY2tQZXJtaXNzaW9ucygpO1xuICAgICAgICB0aGlzLnVwZGF0ZUxpa2VzKCk7XG5cbiAgICAgICAgLy8gQ2FyZCdzIHRpdGxlXG4gICAgICAgIHRoaXMuX3RpdGxlRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG5cbiAgICAgICAgLy8gQ2FyZCdzIGltYWdlXG4gICAgICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xuICAgICAgICB0aGlzLl9pbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcblxuICAgICAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGEgY2FyZCBlbGVtZW50LlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIHJlbW92ZUVsZW1lbnQoKSB7XG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgbGlrZXMgb2YgdGhlIGNhcmQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaWtlc1xuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICB1cGRhdGVMaWtlcyh7bGlrZXN9ID0ge30pIHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlcmUncyBhbiB1cGRhdGVkIHJlc3BvbnNlIGZyb20gdGhlIHNlcnZlclxuICAgICAgICB0aGlzLl9saWtlcyA9IGxpa2VzIHx8IHRoaXMuX2xpa2VzO1xuXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBsb2dnZWQtaW4gdXNlciBoYXMgbGlrZWQgdGhlIGNhcmQsIGFuZCBjaGFuZ2UgaXRzJyBzdGF0ZSBhY2NvcmRpbmdseVxuICAgICAgICB0aGlzLl9pc0xpa2VkKCkgPyB0aGlzLl9tYXJrTGlrZWQoKSA6IHRoaXMuX21hcmtEaXNsaWtlZCgpO1xuXG4gICAgICAgIC8vIFVwZGF0ZSB0aGUgY291bnRlclxuICAgICAgICB0aGlzLl9saWtlQ291bnRlckVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgY2FyZCBlbGVtZW50IGZyb20gZGVmaW5lZCB0ZW1wbGF0ZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2NyZWF0ZUZyb21UZW1wbGF0ZSgpIHtcbiAgICAgICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVTZWxlY3RvcilcbiAgICAgICAgICAgIC5jb250ZW50XG4gICAgICAgICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAgICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgICAgIHRoaXMuX3RpdGxlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGl0bGVTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2ltYWdlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5faW1hZ2VTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b25FbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9saWtlQnV0dG9uU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9saWtlQ291bnRlckVsZW1lbnQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2xpa2VDb3VudGVyU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9yZW1vdmVCdXR0b25FbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9yZW1vdmVCdXR0b25TZWxlY3Rvcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IGV2ZW50IGxpc3RlbmVycyBmb3IgY2FyZCdzIGVsZW1lbnQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5faW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5faGFuZGxlSW1hZ2VDbGljayk7XG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b25FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMuX2lkLCB0aGlzLl9pc0xpa2VkKCkpKTtcbiAgICAgICAgdGhpcy5fcmVtb3ZlQnV0dG9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuX2hhbmRsZVJlbW92ZUNsaWNrKHRoaXMuX2lkKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgd2hldGhlciB0aGUgY3VycmVudGx5IGxvZ2dlZC1pbiB1c2VyIGlzIHRoZSBvd25lciBvZiB0aGUgY2FyZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2NoZWNrUGVybWlzc2lvbnMoKSB7XG4gICAgICAgIC8vIElmIG5vdCwgZGlzYWJsZSB0aGUgcmVtb3ZlIGJ1dHRvblxuICAgICAgICBpZiAodGhpcy5fb3duZXIuX2lkICE9PSB0aGlzLl91c2VySWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlbW92ZUJ1dHRvbkVsZW1lbnQucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayB3aGV0aGVyIHRoZSBjdXJyZW50bHkgbG9nZ2VkLWluIHVzZXIgaGFzIGxpa2VkIHRoZSBjYXJkLlxuICAgICAqXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfaXNMaWtlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUodXNlckRhdGEgPT4gdXNlckRhdGEuX2lkID09PSB0aGlzLl91c2VySWQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1hcmsgdGhlIGNhcmQgYXMgbGlrZWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9tYXJrTGlrZWQoKSB7XG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fbGlrZUJ1dHRvbkFjdGl2ZUNsYXNzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNYXJrIHRoZSBjYXJkIGFzIGRpc2xpa2VkLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfbWFya0Rpc2xpa2VkKCkge1xuICAgICAgICB0aGlzLl9saWtlQnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2xpa2VCdXR0b25BY3RpdmVDbGFzcyk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xuIiwiY2xhc3MgRGlhbG9ndWUge1xuICAgIC8vIFNlbGVjdG9ycyBhbmQgY2xhc3Nlc1xuICAgIF9iYWNrZ3JvdW5kQ2xhc3MgPSAnZGlhbG9ndWUnO1xuICAgIF9jbG9zZUJ1dHRvbkNsYXNzID0gJ2RpYWxvZ3VlX19jbG9zZS1idXR0b24nO1xuICAgIF9vcGVuZWRDbGFzcyA9ICdkaWFsb2d1ZV9vcGVuZWQnO1xuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSBhIGRpYWxvZ3VlIGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRpYWxvZ3VlU2VsZWN0b3JcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoZGlhbG9ndWVTZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9kaWFsb2d1ZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRpYWxvZ3VlU2VsZWN0b3IpO1xuXG4gICAgICAgIC8vIEJpbmQgdGhlIGN1cnJlbnQgaW5zdGFuY2UgdG8gdGhlIGV2ZW50IGhhbmRsZXJzXG4gICAgICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5faGFuZGxlQ2xpY2tDbG9zZSA9IHRoaXMuX2hhbmRsZUNsaWNrQ2xvc2UuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPcGVuIHRoZSBkaWFsb2d1ZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBvcGVuKCkge1xuICAgICAgICB0aGlzLl9kaWFsb2d1ZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9vcGVuZWRDbGFzcyk7XG4gICAgICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbG9zZSB0aGUgZGlhbG9ndWUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX2RpYWxvZ3VlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX29wZW5lZENsYXNzKTtcbiAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVycygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBldmVudCBsaXN0ZW5lcnMgdG8gdGhlIGRpYWxvZ3VlLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgICAgICB0aGlzLl9kaWFsb2d1ZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVDbGlja0Nsb3NlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgZXZlbnQgbGlzdGVuZXJzIGZyb20gdGhlIGRpYWxvZ3VlLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHJlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgICAgICB0aGlzLl9kaWFsb2d1ZUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVDbGlja0Nsb3NlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgY2xvc2luZyB0aGUgZGlhbG9ndWUgaWYgXCJlc2NhcGVcIiB3YXMgcHJlc3NlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfaGFuZGxlRXNjQ2xvc2UoZXZlbnQpIHtcbiAgICAgICAgKGV2ZW50LmtleSA9PT0gJ0VzY2FwZScpICYmIHRoaXMuY2xvc2UoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgY2xvc2luZyB0aGUgZGlhbG9ndWUgaWYgdGhlIHVzZXIgY2xpY2tlZCBvbiB0aGUgYmFja2dyb3VuZCAvIHRoZSBjbG9zZSBidXR0b24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2hhbmRsZUNsaWNrQ2xvc2UoZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5fYmFja2dyb3VuZENsYXNzKSB8fFxuICAgICAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyh0aGlzLl9jbG9zZUJ1dHRvbkNsYXNzKSkge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBEaWFsb2d1ZTtcbiIsImltcG9ydCBEaWFsb2d1ZSBmcm9tICcuL0RpYWxvZ3VlJztcblxuY2xhc3MgRGlhbG9ndWVXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgRGlhbG9ndWUge1xuICAgIC8vIFNlbGVjdG9ycyBhbmQgY2xhc3Nlc1xuICAgIF9idXR0b25TZWxlY3RvciA9ICcuZGlhbG9ndWVfX3N1Ym1pdC1idXR0b24nO1xuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSBhIGRpYWxvZ3VlIHdpdGggYWxlcnQgaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGlhbG9ndWVTZWxlY3RvclxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihkaWFsb2d1ZVNlbGVjdG9yKSB7XG4gICAgICAgIHN1cGVyKGRpYWxvZ3VlU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZGlhbG9ndWVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fYnV0dG9uU2VsZWN0b3IpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE9wZW4gdGhlIGRpYWxvZ3VlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY29uZmlybWF0aW9uQ2FsbGJhY2tcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgb3Blbihjb25maXJtYXRpb25DYWxsYmFjaykge1xuICAgICAgICB0aGlzLl9jb25maXJtYXRpb25DYWxsYmFjayA9IGNvbmZpcm1hdGlvbkNhbGxiYWNrO1xuICAgICAgICBzdXBlci5vcGVuKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGV2ZW50IGxpc3RlbmVycyB0byB0aGUgZGlhbG9ndWUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9jb25maXJtYXRpb25DYWxsYmFjayk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGV2ZW50IGxpc3RlbmVycyBmcm9tIHRoZSBkaWFsb2d1ZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICByZW1vdmVFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgc3VwZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2NvbmZpcm1hdGlvbkNhbGxiYWNrKTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IERpYWxvZ3VlV2l0aENvbmZpcm1hdGlvbjtcbiIsImltcG9ydCBEaWFsb2d1ZSBmcm9tICcuL0RpYWxvZ3VlJztcblxuY2xhc3MgRGlhbG9ndWVXaXRoRm9ybSBleHRlbmRzIERpYWxvZ3VlIHtcbiAgICAvLyBTZWxlY3RvcnMgYW5kIGNsYXNzZXNcbiAgICBfZm9ybVNlbGVjdG9yID0gJy5kaWFsb2d1ZV9fZm9ybSc7XG4gICAgX2J1dHRvblNlbGVjdG9yID0gJy5kaWFsb2d1ZV9fc3VibWl0LWJ1dHRvbic7XG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplIGEgZGlhbG9ndWUgd2l0aCBmb3JtIGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRpYWxvZ3VlU2VsZWN0b3JcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdWJtaXNzaW9uQ2FsbGJhY2tcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoZGlhbG9ndWVTZWxlY3Rvciwgc3VibWlzc2lvbkNhbGxiYWNrKSB7XG4gICAgICAgIHN1cGVyKGRpYWxvZ3VlU2VsZWN0b3IpO1xuXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fZGlhbG9ndWVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fZm9ybVNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2RpYWxvZ3VlRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2J1dHRvblNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fc3VibWlzc2lvbkNhbGxiYWNrID0gc3VibWlzc2lvbkNhbGxiYWNrO1xuXG4gICAgICAgIC8vIEJpbmQgdGhlIGN1cnJlbnQgaW5zdGFuY2UgdG8gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pc3Npb24gPSB0aGlzLl9oYW5kbGVGb3JtU3VibWlzc2lvbi5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsb3NlIHRoZSBkaWFsb2d1ZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgZGVmYXVsdCBpbnB1dCB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgc2V0SW5wdXRWYWx1ZXMoaW5wdXRzTGlzdCkge1xuICAgICAgICBmb3IgKGNvbnN0IGlucHV0TmFtZSBpbiBpbnB1dHNMaXN0KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fZm9ybUVsZW1lbnQuZWxlbWVudHNbaW5wdXROYW1lXSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmVsZW1lbnRzW2lucHV0TmFtZV0udmFsdWUgPSBpbnB1dHNMaXN0W2lucHV0TmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgbG9hZGluZyBzdGF0ZTsgdXNlZCB3aGVuIHdhaXRpbmcgZm9yIHJlc3BvbnNlIGZyb20gdGhlIHNlcnZlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNMb2FkaW5nXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIHNldExvYWRpbmdTdGF0ZShpc0xvYWRpbmcpIHtcbiAgICAgICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC50ZXh0Q29udGVudCA9ICdTYXZpbmcuLi4nO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC50ZXh0Q29udGVudCA9ICdTYXZlJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBldmVudCBsaXN0ZW5lcnMgdG8gdGhlIGRpYWxvZ3VlLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9oYW5kbGVGb3JtU3VibWlzc2lvbik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGV2ZW50IGxpc3RlbmVycyBmcm9tIHRoZSBkaWFsb2d1ZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICByZW1vdmVFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgc3VwZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5faGFuZGxlRm9ybVN1Ym1pc3Npb24pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSB0aGUgc3VibWlzc2lvbiBvZiB0aGUgZm9ybS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfaGFuZGxlRm9ybVN1Ym1pc3Npb24oZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5fc3VibWlzc2lvbkNhbGxiYWNrKHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhbGwgdGhlIGlucHV0cyBvZiB0aGUgZm9ybS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtBcnJheX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Zvcm1FbGVtZW50LmVsZW1lbnRzO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRGlhbG9ndWVXaXRoRm9ybTtcbiIsImltcG9ydCBEaWFsb2d1ZSBmcm9tICcuL0RpYWxvZ3VlJztcblxuY2xhc3MgRGlhbG9ndWVXaXRoSW1hZ2UgZXh0ZW5kcyBEaWFsb2d1ZSB7XG4gICAgLy8gU2VsZWN0b3JzIGFuZCBjbGFzc2VzXG4gICAgX2ltYWdlU2VsZWN0b3IgPSAnLmRpYWxvZ3VlX19pbWFnZSc7XG4gICAgX2NhcHRpb25TZWxlY3RvciA9ICcuZGlhbG9ndWVfX2NhcHRpb24nO1xuXG4gICAgLyoqXG4gICAgICogT3BlbiB0aGUgZGlhbG9ndWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsaW5rXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIG9wZW4oe25hbWUsIGxpbmt9KSB7XG4gICAgICAgIHN1cGVyLm9wZW4oKTtcblxuICAgICAgICAvLyBEaWFsb2d1ZSdzIGltYWdlXG4gICAgICAgIGNvbnN0IGltYWdlRWxlbWVudCA9IHRoaXMuX2RpYWxvZ3VlRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2ltYWdlU2VsZWN0b3IpO1xuICAgICAgICBpbWFnZUVsZW1lbnQuYWx0ID0gbmFtZTtcbiAgICAgICAgaW1hZ2VFbGVtZW50LnNyYyA9IGxpbms7XG5cbiAgICAgICAgLy8gRGlhbG9ndWUncyBjYXB0aW9uXG4gICAgICAgIGNvbnN0IGNhcHRpb25FbGVtZW50ID0gdGhpcy5fZGlhbG9ndWVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FwdGlvblNlbGVjdG9yKTtcbiAgICAgICAgY2FwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRGlhbG9ndWVXaXRoSW1hZ2U7XG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplIGEgZm9ybSB2YWxpZGF0b3IgaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGZvcm1FbGVtZW50XG4gICAgICogQHBhcmFtIHtPYmplY3R9IHZhbGlkYXRpb25TZXR0aW5nc1xuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihmb3JtRWxlbWVudCwgdmFsaWRhdGlvblNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgICAgIHRoaXMuX3ZhbGlkYXRpb25TZXR0aW5ncyA9IHZhbGlkYXRpb25TZXR0aW5ncztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFbmFibGUgZm9ybSB2YWxpZGF0aW9uLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgICAgIHRoaXMuX2FuYWx5emVGb3JtKCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZVN1Ym1pdEJ1dHRvblN0YXRlKCk7XG5cbiAgICAgICAgLy8gR28gdGhyb3VnaCB0aGUgaW5wdXRzIGxpc3QsIGFuZCBhdHRhY2ggdG8gZWFjaCBhbiBldmVudCBsaXN0ZW5lciB3aGljaCB3YXRjaGVzIGZvciBjaGFuZ2VzXG4gICAgICAgIHRoaXMuX2lucHV0c0xpc3QuZm9yRWFjaChpbnB1dEVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RvZ2dsZVN1Ym1pdEJ1dHRvblN0YXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gTWFrZSB0aGUgc3VibWl0IGJ1dHRvbiBkaXNhYmxlZCBhZ2FpbiBhZnRlciB0aGUgZm9ybSBpcyByZXNldFxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdyZXNldCcsICgpID0+IHRoaXMuX21ha2VTdWJtaXRCdXR0b25EaXNhYmxlZCgpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBbmFseXplIHRoZSBwYXNzZWQgZm9ybSBlbGVtZW50LlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfYW5hbHl6ZUZvcm0oKSB7XG4gICAgICAgIC8vIEdldCBhbGwgdGhlIGlucHV0c1xuICAgICAgICB0aGlzLl9pbnB1dHNMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3ZhbGlkYXRpb25TZXR0aW5ncy5pbnB1dFNlbGVjdG9yKSk7XG5cbiAgICAgICAgLy8gR2V0IHRoZSBzdWJtaXQgYnV0dG9uXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3ZhbGlkYXRpb25TZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGV0ZXJtaW5lIHdoZXRoZXIgYW4gaW5wdXQgaGFzIGFuIGVycm9yLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBpbnB1dEVsZW1lbnRcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWFrZSBhbiBpbnB1dCBlcnJvciB2aXNpYmxlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBpbnB1dEVsZW1lbnRcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXJyb3JNZXNzYWdlXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZ2V0SW5wdXRFcnJvckVsZW1lbnQoaW5wdXRFbGVtZW50KTtcblxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl92YWxpZGF0aW9uU2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fdmFsaWRhdGlvblNldHRpbmdzLmVycm9yVmlzaWJsZUNsYXNzKTtcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1ha2UgYW4gaW5wdXQgZXJyb3IgaGlkZGVuLlxuICAgICAqXG4gICAgICogQHBhcmFtIGlucHV0RWxlbWVudFxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9nZXRJbnB1dEVycm9yRWxlbWVudChpbnB1dEVsZW1lbnQpO1xuXG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3ZhbGlkYXRpb25TZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl92YWxpZGF0aW9uU2V0dGluZ3MuZXJyb3JWaXNpYmxlQ2xhc3MpO1xuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlIHRoZSBlcnJvciBlbGVtZW50IG9mIGEgc3BlY2lmaWMgaW5wdXQgZWxlbWVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gaW5wdXRFbGVtZW50XG4gICAgICogQHJldHVybnMge0VsZW1lbnR9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfZ2V0SW5wdXRFcnJvckVsZW1lbnQoaW5wdXRFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGVycm9yU2VsZWN0b3IgPSB0aGlzLl92YWxpZGF0aW9uU2V0dGluZ3MuaW5wdXRFcnJvclNlbGVjdG9yXG4gICAgICAgICAgICAucmVwbGFjZSgnJWZvcm1JZCcsIHRoaXMuX2Zvcm1FbGVtZW50LmlkKVxuICAgICAgICAgICAgLnJlcGxhY2UoJyVpbnB1dE5hbWUnLCBpbnB1dEVsZW1lbnQubmFtZSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoZXJyb3JTZWxlY3Rvcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGV0ZXJtaW5lIHRoZSBzdGF0ZSBvZiB0aGUgc3VibWl0IGJ1dHRvbiAoYWN0aXZlIC8gZGlzYWJsZWQpLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfdG9nZ2xlU3VibWl0QnV0dG9uU3RhdGUoKSB7XG4gICAgICAgIHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpID8gdGhpcy5fbWFrZVN1Ym1pdEJ1dHRvbkRpc2FibGVkKCkgOiB0aGlzLl9tYWtlU3VibWl0QnV0dG9uQWN0aXZlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgd2hldGhlciBhbGwgaW5wdXRzIGFyZSB2YWxpZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0c0xpc3Quc29tZShpbnB1dEVsZW1lbnQgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWFrZSB0aGUgc3VibWl0IGJ1dHRvbiBhY3RpdmUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9tYWtlU3VibWl0QnV0dG9uQWN0aXZlKCkge1xuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fdmFsaWRhdGlvblNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWFrZSB0aGUgc3VibWl0IGJ1dHRvbiBkaXNhYmxlZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX21ha2VTdWJtaXRCdXR0b25EaXNhYmxlZCgpIHtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3ZhbGlkYXRpb25TZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xuIiwiY2xhc3MgU2VjdGlvbiB7XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSBhIHNlY3Rpb24gaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY29udGFpbmVyU2VsZWN0b3JcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSByZW5kZXJlckNhbGxiYWNrXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lclNlbGVjdG9yLCByZW5kZXJlckNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fcmVuZGVyZXJDYWxsYmFjayA9IHJlbmRlcmVyQ2FsbGJhY2s7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIGl0ZW1zIGZyb20gbGlzdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICByZW5kZXJJdGVtcyhpdGVtc0xpc3QpIHtcbiAgICAgICAgaXRlbXNMaXN0LmZvckVhY2goaXRlbSA9PiB0aGlzLl9yZW5kZXJlckNhbGxiYWNrKGl0ZW0pKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYW4gZWxlbWVudCB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSBzZWN0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50XG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGFkZEVsZW1lbnRGaXJzdChlbGVtZW50KSB7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lckVsZW1lbnQucHJlcGVuZChlbGVtZW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYW4gZWxlbWVudCB0byB0aGUgZW5kIG9mIHRoZSBzZWN0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50XG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGFkZEVsZW1lbnRMYXN0KGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5fY29udGFpbmVyRWxlbWVudC5hcHBlbmQoZWxlbWVudCk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTZWN0aW9uO1xuIiwiY2xhc3MgVXNlckluZm8ge1xuICAgIC8vIERlZmF1bHQgaW5mb3JtYXRpb25cbiAgICBfaWQgPSB1bmRlZmluZWQ7XG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplIGEgdXNlciBpbmZvIGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVTZWxlY3RvclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhYm91dFNlbGVjdG9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGF2YXRhclNlbGVjdG9yXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHtuYW1lU2VsZWN0b3IsIGFib3V0U2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yfSkge1xuICAgICAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fYWJvdXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhYm91dFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlIHVzZXIncyBpbmZvcm1hdGlvbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IHRoaXMuX2lkLFxuICAgICAgICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICAgICAgICBhYm91dDogdGhpcy5fYWJvdXRFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXJFbGVtZW50LnNyY1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB1c2VyJ3MgaW5mb3JtYXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gX2lkXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYWJvdXRcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYXZhdGFyXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIHNldFVzZXJJbmZvKHtfaWQsIG5hbWUsIGFib3V0LCBhdmF0YXJ9KSB7XG4gICAgICAgIHRoaXMuX2lkID0gX2lkIHx8IHRoaXMuX2lkO1xuICAgICAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgICAgIHRoaXMuX2Fib3V0RWxlbWVudC50ZXh0Q29udGVudCA9IGFib3V0O1xuICAgICAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IGF2YXRhcjtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvO1xuIiwiZXhwb3J0IGNvbnN0IGFwaUJhc2VVcmwgPSAnaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMic7XG5leHBvcnQgY29uc3QgYXBpQXV0aEtleSA9ICcxOTBlOTQ4Ni1jZjg0LTQzNzAtYWE0Mi04MDgzMTE1MmFkODInO1xuXG5leHBvcnQgY29uc3QgYnV0dG9uQ2FyZEFkZFNlbGVjdG9yID0gJy5wcm9maWxlX19hZGQtYnV0dG9uJztcbmV4cG9ydCBjb25zdCBidXR0b25Qcm9maWxlQ2hhbmdlUGljdHVyZVNlbGVjdG9yID0gJy5wcm9maWxlX19hdmF0YXItb3ZlcmxheSc7XG5leHBvcnQgY29uc3QgYnV0dG9uUHJvZmlsZUVkaXRTZWxlY3RvciA9ICcucHJvZmlsZV9fZWRpdC1idXR0b24nO1xuXG5leHBvcnQgY29uc3QgY2FyZHNDb250YWluZXJTZWxlY3RvciA9ICcuY2FyZHNfX2xpc3QnO1xuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZVNlbGVjdG9yID0gJyNjYXJkLXRlbXBsYXRlJztcblxuZXhwb3J0IGNvbnN0IGRpYWxvZ3VlQ2FyZEFkZFNlbGVjdG9yID0gJy5kaWFsb2d1ZV90eXBlX2NhcmQtYWRkJztcbmV4cG9ydCBjb25zdCBkaWFsb2d1ZUNhcmRSZW1vdmVTZWxlY3RvciA9ICcuZGlhbG9ndWVfdHlwZV9jYXJkLXJlbW92ZSc7XG5leHBvcnQgY29uc3QgZGlhbG9ndWVDYXJkVmlld1NlbGVjdG9yID0gJy5kaWFsb2d1ZV90eXBlX2NhcmQtdmlldyc7XG5leHBvcnQgY29uc3QgZGlhbG9ndWVQcm9maWxlQ2hhbmdlUGljdHVyZVNlbGVjdG9yID0gJy5kaWFsb2d1ZV90eXBlX3Byb2ZpbGUtY2hhbmdlLXBpY3R1cmUnO1xuZXhwb3J0IGNvbnN0IGRpYWxvZ3VlUHJvZmlsZUVkaXRTZWxlY3RvciA9ICcuZGlhbG9ndWVfdHlwZV9wcm9maWxlLWVkaXQnO1xuXG5leHBvcnQgY29uc3QgZXJyb3JTZWxlY3RvciA9ICcuZXJyb3InO1xuZXhwb3J0IGNvbnN0IGVycm9yVmlzaWJsZUNsYXNzID0gJ2Vycm9yX3Zpc2libGUnO1xuXG5leHBvcnQgY29uc3QgdXNlckluZm9BYm91dFNlbGVjdG9yID0gJy5wcm9maWxlX19zdWJ0aXRsZSc7XG5leHBvcnQgY29uc3QgdXNlckluZm9BdmF0YXJTZWxlY3RvciA9ICcucHJvZmlsZV9fYXZhdGFyLWltYWdlJztcbmV4cG9ydCBjb25zdCB1c2VySW5mb05hbWVTZWxlY3RvciA9ICcucHJvZmlsZV9fdGl0bGUtdGV4dCc7XG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XG4gICAgZm9ybVNlbGVjdG9yOiAnLmRpYWxvZ3VlX19mb3JtJyxcbiAgICBpbnB1dFNlbGVjdG9yOiAnLmRpYWxvZ3VlX19mb3JtLWZpZWxkJyxcbiAgICBpbnB1dEVycm9yU2VsZWN0b3I6ICcuJWZvcm1JZC0laW5wdXROYW1lLWVycm9yJyxcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5kaWFsb2d1ZV9fc3VibWl0LWJ1dHRvbicsXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogJ2RpYWxvZ3VlX19zdWJtaXQtYnV0dG9uX2Rpc2FibGVkJyxcbiAgICBpbnB1dEVycm9yQ2xhc3M6ICdkaWFsb2d1ZV9fZm9ybS1maWVsZF9oYXMtZXJyb3InLFxuICAgIGVycm9yVmlzaWJsZUNsYXNzOiAnZGlhbG9ndWVfX2Zvcm0tZXJyb3JfdmlzaWJsZSdcbn07XG4iLCJpbXBvcnQgQXBpIGZyb20gJy4uL2NvbXBvbmVudHMvQXBpJztcbmltcG9ydCBDYXJkIGZyb20gJy4uL2NvbXBvbmVudHMvQ2FyZCc7XG5pbXBvcnQgRGlhbG9ndWVXaXRoQ29uZmlybWF0aW9uIGZyb20gJy4uL2NvbXBvbmVudHMvRGlhbG9ndWVXaXRoQ29uZmlybWF0aW9uJztcbmltcG9ydCBEaWFsb2d1ZVdpdGhGb3JtIGZyb20gJy4uL2NvbXBvbmVudHMvRGlhbG9ndWVXaXRoRm9ybSc7XG5pbXBvcnQgRGlhbG9ndWVXaXRoSW1hZ2UgZnJvbSAnLi4vY29tcG9uZW50cy9EaWFsb2d1ZVdpdGhJbWFnZSc7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tICcuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3InO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSAnLi4vY29tcG9uZW50cy9TZWN0aW9uJztcbmltcG9ydCBVc2VySW5mbyBmcm9tICcuLi9jb21wb25lbnRzL1VzZXJJbmZvJztcbmltcG9ydCB7XG4gICAgYXBpQXV0aEtleSxcbiAgICBhcGlCYXNlVXJsLFxuICAgIGJ1dHRvbkNhcmRBZGRTZWxlY3RvcixcbiAgICBidXR0b25Qcm9maWxlQ2hhbmdlUGljdHVyZVNlbGVjdG9yLFxuICAgIGJ1dHRvblByb2ZpbGVFZGl0U2VsZWN0b3IsXG4gICAgY2FyZHNDb250YWluZXJTZWxlY3RvcixcbiAgICBjYXJkVGVtcGxhdGVTZWxlY3RvcixcbiAgICBkaWFsb2d1ZUNhcmRBZGRTZWxlY3RvcixcbiAgICBkaWFsb2d1ZUNhcmRSZW1vdmVTZWxlY3RvcixcbiAgICBkaWFsb2d1ZUNhcmRWaWV3U2VsZWN0b3IsXG4gICAgZGlhbG9ndWVQcm9maWxlQ2hhbmdlUGljdHVyZVNlbGVjdG9yLFxuICAgIGRpYWxvZ3VlUHJvZmlsZUVkaXRTZWxlY3RvcixcbiAgICBlcnJvclNlbGVjdG9yLFxuICAgIGVycm9yVmlzaWJsZUNsYXNzLFxuICAgIHVzZXJJbmZvQWJvdXRTZWxlY3RvcixcbiAgICB1c2VySW5mb0F2YXRhclNlbGVjdG9yLFxuICAgIHVzZXJJbmZvTmFtZVNlbGVjdG9yLFxuICAgIHZhbGlkYXRpb25TZXR0aW5nc1xufSBmcm9tICcuLi91dGlsaXRpZXMvY29uc3RhbnRzJztcbmltcG9ydCAnLi9pbmRleC5jc3MnO1xuXG4vKlxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBJTlNUQU5DRVNcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICovXG5cbi8qKlxuICogQ3JlYXRlIGFuIGluc3RhbmNlIG9mIEFwaS5cbiAqXG4gKiBAdHlwZSB7QXBpfVxuICovXG5jb25zdCBhcGkgPSBuZXcgQXBpKGFwaUJhc2VVcmwsIGFwaUF1dGhLZXkpO1xuXG4vKipcbiAqIENyZWF0ZSBhbiBpbnN0YW5jZSBvZiBTZWN0aW9uIGZvciB0aGUgY2FyZHMgY29udGFpbmVyLlxuICpcbiAqIEB0eXBlIHtTZWN0aW9ufVxuICovXG5jb25zdCBjYXJkc0NvbnRhaW5lciA9IG5ldyBTZWN0aW9uKFxuICAgIGNhcmRzQ29udGFpbmVyU2VsZWN0b3IsXG4gICAgY2FyZERhdGEgPT4gY2FyZHNDb250YWluZXIuYWRkRWxlbWVudExhc3QoXG4gICAgICAgIGNyZWF0ZUNhcmQoY2FyZERhdGEpXG4gICAgKVxuKTtcblxuLyoqXG4gKiBDcmVhdGUgYW4gaW5zdGFuY2Ugb2YgRGlhbG9ndWVXaXRoRm9ybSBmb3IgdGhlIGNhcmQtYWRkIGRpYWxvZ3VlLlxuICpcbiAqIEB0eXBlIHtEaWFsb2d1ZVdpdGhGb3JtfVxuICovXG5jb25zdCBkaWFsb2d1ZUNhcmRBZGQgPSBuZXcgRGlhbG9ndWVXaXRoRm9ybShkaWFsb2d1ZUNhcmRBZGRTZWxlY3RvciwgaW5wdXRzTGlzdCA9PiB7XG4gICAgZGlhbG9ndWVDYXJkQWRkLnNldExvYWRpbmdTdGF0ZSh0cnVlKTtcblxuICAgIGFwaS5hZGRDYXJkKHtcbiAgICAgICAgbmFtZTogaW5wdXRzTGlzdC50aXRsZS52YWx1ZSxcbiAgICAgICAgbGluazogaW5wdXRzTGlzdC5pbWFnZS52YWx1ZVxuICAgIH0pXG4gICAgICAgIC50aGVuKHJlc3BvbnNlID0+IGNhcmRzQ29udGFpbmVyLmFkZEVsZW1lbnRGaXJzdChcbiAgICAgICAgICAgIGNyZWF0ZUNhcmQocmVzcG9uc2UpXG4gICAgICAgICkpXG4gICAgICAgIC5jYXRjaChoYW5kbGVTZXJ2ZXJFcnJvcilcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgZGlhbG9ndWVDYXJkQWRkLmNsb3NlKCk7XG4gICAgICAgICAgICBkaWFsb2d1ZUNhcmRBZGQuc2V0TG9hZGluZ1N0YXRlKGZhbHNlKTtcbiAgICAgICAgfSk7XG59KTtcblxuLyoqXG4gKiBDcmVhdGUgYW4gaW5zdGFuY2Ugb2YgRGlhbG9ndWVXaXRoQ29uZmlybWF0aW9uIGZvciB0aGUgY2FyZC1yZW1vdmUgZGlhbG9ndWUuXG4gKlxuICogQHR5cGUge0RpYWxvZ3VlV2l0aENvbmZpcm1hdGlvbn1cbiAqL1xuY29uc3QgZGlhbG9ndWVDYXJkUmVtb3ZlID0gbmV3IERpYWxvZ3VlV2l0aENvbmZpcm1hdGlvbihkaWFsb2d1ZUNhcmRSZW1vdmVTZWxlY3Rvcik7XG5cbi8qKlxuICogQ3JlYXRlIGFuIGluc3RhbmNlIG9mIERpYWxvZ3VlV2l0aEltYWdlIGZvciB0aGUgY2FyZC12aWV3IGRpYWxvZ3VlLlxuICpcbiAqIEB0eXBlIHtEaWFsb2d1ZVdpdGhJbWFnZX1cbiAqL1xuY29uc3QgZGlhbG9ndWVDYXJkVmlldyA9IG5ldyBEaWFsb2d1ZVdpdGhJbWFnZShkaWFsb2d1ZUNhcmRWaWV3U2VsZWN0b3IpO1xuXG4vKipcbiAqIENyZWF0ZSBhbiBpbnN0YW5jZSBvZiBEaWFsb2d1ZVdpdGhGb3JtIGZvciB0aGUgcHJvZmlsZS1jaGFuZ2UtcGljdHVyZSBkaWFsb2d1ZS5cbiAqXG4gKiBAdHlwZSB7RGlhbG9ndWVXaXRoRm9ybX1cbiAqL1xuY29uc3QgZGlhbG9ndWVQcm9maWxlQ2hhbmdlUGljdHVyZSA9IG5ldyBEaWFsb2d1ZVdpdGhGb3JtKGRpYWxvZ3VlUHJvZmlsZUNoYW5nZVBpY3R1cmVTZWxlY3RvciwgaW5wdXRzTGlzdCA9PiB7XG4gICAgZGlhbG9ndWVQcm9maWxlQ2hhbmdlUGljdHVyZS5zZXRMb2FkaW5nU3RhdGUodHJ1ZSk7XG5cbiAgICBhcGkudXBkYXRlVXNlckF2YXRhcih7XG4gICAgICAgIGF2YXRhcjogaW5wdXRzTGlzdC5hdmF0YXIudmFsdWVcbiAgICB9KVxuICAgICAgICAudGhlbihyZXNwb25zZSA9PiB1c2VySW5mby5zZXRVc2VySW5mbyhyZXNwb25zZSkpXG4gICAgICAgIC5jYXRjaChoYW5kbGVTZXJ2ZXJFcnJvcilcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgZGlhbG9ndWVQcm9maWxlQ2hhbmdlUGljdHVyZS5jbG9zZSgpO1xuICAgICAgICAgICAgZGlhbG9ndWVQcm9maWxlQ2hhbmdlUGljdHVyZS5zZXRMb2FkaW5nU3RhdGUoZmFsc2UpO1xuICAgICAgICB9KTtcbn0pO1xuXG4vKipcbiAqIENyZWF0ZSBhbiBpbnN0YW5jZSBvZiBEaWFsb2d1ZVdpdGhGb3JtIGZvciB0aGUgcHJvZmlsZS1lZGl0IGRpYWxvZ3VlLlxuICpcbiAqIEB0eXBlIHtEaWFsb2d1ZVdpdGhGb3JtfVxuICovXG5jb25zdCBkaWFsb2d1ZVByb2ZpbGVFZGl0ID0gbmV3IERpYWxvZ3VlV2l0aEZvcm0oZGlhbG9ndWVQcm9maWxlRWRpdFNlbGVjdG9yLCBpbnB1dHNMaXN0ID0+IHtcbiAgICBkaWFsb2d1ZVByb2ZpbGVFZGl0LnNldExvYWRpbmdTdGF0ZSh0cnVlKTtcblxuICAgIGFwaS51cGRhdGVVc2VySW5mbyh7XG4gICAgICAgIG5hbWU6IGlucHV0c0xpc3QubmFtZS52YWx1ZSxcbiAgICAgICAgYWJvdXQ6IGlucHV0c0xpc3QuYWJvdXQudmFsdWVcbiAgICB9KVxuICAgICAgICAudGhlbihyZXNwb25zZSA9PiB1c2VySW5mby5zZXRVc2VySW5mbyhyZXNwb25zZSkpXG4gICAgICAgIC5jYXRjaChoYW5kbGVTZXJ2ZXJFcnJvcilcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgZGlhbG9ndWVQcm9maWxlRWRpdC5jbG9zZSgpO1xuICAgICAgICAgICAgZGlhbG9ndWVQcm9maWxlRWRpdC5zZXRMb2FkaW5nU3RhdGUoZmFsc2UpO1xuICAgICAgICB9KTtcbn0pO1xuXG4vKipcbiAqIENyZWF0ZSBhbiBpbnN0YW5jZSBvZiBVc2VySW5mbyBmb3IgdGhlIHVzZXIgcHJvZmlsZS5cbiAqXG4gKiBAdHlwZSB7VXNlckluZm99XG4gKi9cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgICBuYW1lU2VsZWN0b3I6IHVzZXJJbmZvTmFtZVNlbGVjdG9yLFxuICAgIGFib3V0U2VsZWN0b3I6IHVzZXJJbmZvQWJvdXRTZWxlY3RvcixcbiAgICBhdmF0YXJTZWxlY3RvcjogdXNlckluZm9BdmF0YXJTZWxlY3RvclxufSk7XG5cbi8qXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIEZVTkNUSU9OU1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKi9cblxuLyoqXG4gKiBIYW5kbGUgYW4gZXJyb3IgcmVjZWl2ZWQgZnJvbSB0aGUgc2VydmVyLlxuICpcbiAqIEBwYXJhbSB7UHJvbWlzZX0gZXJyb3JcbiAqIEByZXR1cm5zIHt2b2lkfVxuICovXG5jb25zdCBoYW5kbGVTZXJ2ZXJFcnJvciA9IGVycm9yID0+IHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVycm9yU2VsZWN0b3IpO1xuXG4gICAgLy8gU2V0IGVycm9yJ3MgaW5mb3JtYXRpb25cbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvcjtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChlcnJvclZpc2libGVDbGFzcyk7XG5cbiAgICAvLyBIaWRlIHRoZSBlcnJvciBhZnRlciA1IHNlY29uZHNcbiAgICBzZXRUaW1lb3V0KCgpID0+IGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGVycm9yVmlzaWJsZUNsYXNzKSwgNSAqIDEwMDApO1xuXG4gICAgLy8gQWxzbywgbG9nIHRoZSBlcnJvciB0byB0aGUgY29uc29sZVxuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xufTtcblxuLyoqXG4gKiBHZXQgdGhlIGluaXRpYWwgZGF0YSBmcm9tIHRoZSBzZXJ2ZXIsIGFuZCB1cGRhdGUgdGhlIHBhZ2UgYWNjb3JkaW5nbHkuXG4gKlxuICogQHJldHVybnMge3ZvaWR9XG4gKi9cbmNvbnN0IGxvYWRJbml0aWFsRGF0YSA9ICgpID0+IHtcbiAgICAvLyBEaXNwbGF5IGEgbG9hZGluZyBtZXNzYWdlIHdoaWxlIHdhaXRpbmcgZm9yIHJlc3BvbnNlXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgICAuLi51c2VySW5mby5nZXRVc2VySW5mbygpLFxuICAgICAgICBuYW1lOiAnTG9hZGluZy4uLidcbiAgICB9KTtcblxuICAgIC8vIE9yZGVyIG9mIGV4ZWN1dGlvbiBpcyBpbXBvcnRhbnQgaGVyZVxuICAgIFByb21pc2VcbiAgICAgICAgLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRBbGxDYXJkcygpXSlcbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzcG9uc2VbMF0pO1xuICAgICAgICAgICAgY2FyZHNDb250YWluZXIucmVuZGVySXRlbXMocmVzcG9uc2VbMV0pO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goaGFuZGxlU2VydmVyRXJyb3IpO1xufTtcblxuLyoqXG4gKiBDcmVhdGUgYW4gaW5zdGFuY2Ugb2YgRm9ybVZhbGlkYXRvciBmb3IgZWFjaCBmb3JtIG9uIHRoZSBwYWdlLlxuICpcbiAqIEByZXR1cm5zIHt2b2lkfVxuICovXG5jb25zdCBhZGRWYWxpZGF0aW9uVG9Gb3JtcyA9ICgpID0+IHtcbiAgICBjb25zdCBmb3Jtc0xpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodmFsaWRhdGlvblNldHRpbmdzLmZvcm1TZWxlY3RvcikpO1xuXG4gICAgZm9ybXNMaXN0LmZvckVhY2goZm9ybUVsZW1lbnQgPT4ge1xuICAgICAgICBjb25zdCB2YWxpZGF0b3JPYmogPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtRWxlbWVudCwgdmFsaWRhdGlvblNldHRpbmdzKTtcbiAgICAgICAgdmFsaWRhdG9yT2JqLmVuYWJsZVZhbGlkYXRpb24oKTtcbiAgICB9KTtcbn07XG5cbi8qKlxuICogQ3JlYXRlIGEgY2FyZCB3aGljaCBvcGVucyBhIGRpYWxvZ3VlIHdoZW4gY2xpY2tlZC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gY2FyZERhdGFcbiAqIEByZXR1cm5zIHtFbGVtZW50fVxuICovXG5jb25zdCBjcmVhdGVDYXJkID0gY2FyZERhdGEgPT4ge1xuICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICAgICAgY2FyZERhdGEsXG4gICAgICAgIGNhcmRUZW1wbGF0ZVNlbGVjdG9yLFxuICAgICAgICB7XG4gICAgICAgICAgICBoYW5kbGVJbWFnZUNsaWNrOiAoKSA9PiBkaWFsb2d1ZUNhcmRWaWV3Lm9wZW4oY2FyZERhdGEpLFxuICAgICAgICAgICAgaGFuZGxlTGlrZUNsaWNrOiAoY2FyZElkLCBpc0xpa2VkKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGlzTGlrZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXBpLmRpc2xpa2VDYXJkKGNhcmRJZClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IGNhcmQudXBkYXRlTGlrZXMocmVzcG9uc2UpKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGhhbmRsZVNlcnZlckVycm9yKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhcGkubGlrZUNhcmQoY2FyZElkKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gY2FyZC51cGRhdGVMaWtlcyhyZXNwb25zZSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goaGFuZGxlU2VydmVyRXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoYW5kbGVSZW1vdmVDbGljazogY2FyZElkID0+IHtcbiAgICAgICAgICAgICAgICBkaWFsb2d1ZUNhcmRSZW1vdmUub3BlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGFwaS5kZWxldGVDYXJkKGNhcmRJZClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IGNhcmQucmVtb3ZlRWxlbWVudCgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGhhbmRsZVNlcnZlckVycm9yKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4gZGlhbG9ndWVDYXJkUmVtb3ZlLmNsb3NlKCkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB1c2VySW5mby5nZXRVc2VySW5mbygpLmlkXG4gICAgKTtcblxuICAgIHJldHVybiBjYXJkLmdlbmVyYXRlRWxlbWVudCgpO1xufVxuXG4vKlxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBFWEVDVVRJT05TXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqL1xuXG4vLyBDb25uZWN0IHRoZSBjYXJkLWFkZCBidXR0b24gdG8gdGhlIHJlbGF0ZWQgZGlhbG9ndWVcbmNvbnN0IGJ1dHRvbkNhcmRBZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGJ1dHRvbkNhcmRBZGRTZWxlY3Rvcik7XG5idXR0b25DYXJkQWRkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gZGlhbG9ndWVDYXJkQWRkLm9wZW4oKSk7XG5cbi8vIENvbm5lY3QgdGhlIHByb2ZpbGUtY2hhbmdlLXBpY3R1cmUgYnV0dG9uIHRvIHRoZSByZWxhdGVkIGRpYWxvZ3VlXG5jb25zdCBidXR0b25Qcm9maWxlQ2hhbmdlUGljdHVyZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYnV0dG9uUHJvZmlsZUNoYW5nZVBpY3R1cmVTZWxlY3Rvcik7XG5idXR0b25Qcm9maWxlQ2hhbmdlUGljdHVyZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBkaWFsb2d1ZVByb2ZpbGVDaGFuZ2VQaWN0dXJlLnNldElucHV0VmFsdWVzKHVzZXJJbmZvLmdldFVzZXJJbmZvKCkpO1xuICAgIGRpYWxvZ3VlUHJvZmlsZUNoYW5nZVBpY3R1cmUub3BlbigpO1xufSk7XG5cbi8vIENvbm5lY3QgdGhlIHByb2ZpbGUtZWRpdCBidXR0b24gdG8gdGhlIHJlbGF0ZWQgZGlhbG9ndWVcbmNvbnN0IGJ1dHRvblByb2ZpbGVFZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihidXR0b25Qcm9maWxlRWRpdFNlbGVjdG9yKTtcbmJ1dHRvblByb2ZpbGVFZGl0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGRpYWxvZ3VlUHJvZmlsZUVkaXQuc2V0SW5wdXRWYWx1ZXModXNlckluZm8uZ2V0VXNlckluZm8oKSk7XG4gICAgZGlhbG9ndWVQcm9maWxlRWRpdC5vcGVuKCk7XG59KTtcblxubG9hZEluaXRpYWxEYXRhKCk7XG5hZGRWYWxpZGF0aW9uVG9Gb3JtcygpO1xuIl0sIm5hbWVzIjpbIkFwaSIsImJhc2VVcmwiLCJhdXRoS2V5IiwidGhpcyIsIl9iYXNlVXJsIiwiX2F1dGhLZXkiLCJfc2VuZFJlcXVlc3QiLCJ0aGVuIiwiX2NoZWNrUmVzcG9uc2UiLCJuYW1lIiwibGluayIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiaWQiLCJhYm91dCIsImF2YXRhciIsIm1ldGhvZCIsInRhcmdldFVybCIsIm9wdGlvbnMiLCJmZXRjaCIsImhlYWRlcnMiLCJyZXNwb25zZSIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwiQ2FyZCIsInRlbXBsYXRlU2VsZWN0b3IiLCJ1c2VySWQiLCJfaWQiLCJsaWtlcyIsIm93bmVyIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZUxpa2VDbGljayIsImhhbmRsZVJlbW92ZUNsaWNrIiwiX25hbWUiLCJfbGluayIsIl9saWtlcyIsIl9vd25lciIsIl90ZW1wbGF0ZVNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlTGlrZUNsaWNrIiwiX2hhbmRsZVJlbW92ZUNsaWNrIiwiX3VzZXJJZCIsIl9jcmVhdGVGcm9tVGVtcGxhdGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2hlY2tQZXJtaXNzaW9ucyIsInVwZGF0ZUxpa2VzIiwiX3RpdGxlRWxlbWVudCIsInRleHRDb250ZW50IiwiX2ltYWdlRWxlbWVudCIsImFsdCIsInNyYyIsIl9jYXJkRWxlbWVudCIsInJlbW92ZSIsIl9pc0xpa2VkIiwiX21hcmtMaWtlZCIsIl9tYXJrRGlzbGlrZWQiLCJfbGlrZUNvdW50ZXJFbGVtZW50IiwibGVuZ3RoIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsIl9jYXJkU2VsZWN0b3IiLCJjbG9uZU5vZGUiLCJfdGl0bGVTZWxlY3RvciIsIl9pbWFnZVNlbGVjdG9yIiwiX2xpa2VCdXR0b25FbGVtZW50IiwiX2xpa2VCdXR0b25TZWxlY3RvciIsIl9saWtlQ291bnRlclNlbGVjdG9yIiwiX3JlbW92ZUJ1dHRvbkVsZW1lbnQiLCJfcmVtb3ZlQnV0dG9uU2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwic29tZSIsInVzZXJEYXRhIiwiY2xhc3NMaXN0IiwiYWRkIiwiX2xpa2VCdXR0b25BY3RpdmVDbGFzcyIsIkRpYWxvZ3VlIiwiZGlhbG9ndWVTZWxlY3RvciIsIl9kaWFsb2d1ZUVsZW1lbnQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwiX2hhbmRsZUNsaWNrQ2xvc2UiLCJfb3BlbmVkQ2xhc3MiLCJzZXRFdmVudExpc3RlbmVycyIsInJlbW92ZUV2ZW50TGlzdGVuZXJzIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2ZW50Iiwia2V5IiwiY2xvc2UiLCJ0YXJnZXQiLCJjb250YWlucyIsIl9iYWNrZ3JvdW5kQ2xhc3MiLCJfY2xvc2VCdXR0b25DbGFzcyIsIkRpYWxvZ3VlV2l0aENvbmZpcm1hdGlvbiIsIl9idXR0b25FbGVtZW50IiwiX2J1dHRvblNlbGVjdG9yIiwiY29uZmlybWF0aW9uQ2FsbGJhY2siLCJfY29uZmlybWF0aW9uQ2FsbGJhY2siLCJEaWFsb2d1ZVdpdGhGb3JtIiwic3VibWlzc2lvbkNhbGxiYWNrIiwiX2Zvcm1FbGVtZW50IiwiX2Zvcm1TZWxlY3RvciIsIl9zdWJtaXNzaW9uQ2FsbGJhY2siLCJfaGFuZGxlRm9ybVN1Ym1pc3Npb24iLCJyZXNldCIsImlucHV0c0xpc3QiLCJpbnB1dE5hbWUiLCJlbGVtZW50cyIsInZhbHVlIiwiaXNMb2FkaW5nIiwicHJldmVudERlZmF1bHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJEaWFsb2d1ZVdpdGhJbWFnZSIsImltYWdlRWxlbWVudCIsIl9jYXB0aW9uU2VsZWN0b3IiLCJGb3JtVmFsaWRhdG9yIiwiZm9ybUVsZW1lbnQiLCJ2YWxpZGF0aW9uU2V0dGluZ3MiLCJfdmFsaWRhdGlvblNldHRpbmdzIiwiX2FuYWx5emVGb3JtIiwiX3RvZ2dsZVN1Ym1pdEJ1dHRvblN0YXRlIiwiX2lucHV0c0xpc3QiLCJmb3JFYWNoIiwiaW5wdXRFbGVtZW50IiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl9tYWtlU3VibWl0QnV0dG9uRGlzYWJsZWQiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25FbGVtZW50Iiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJfZ2V0SW5wdXRFcnJvckVsZW1lbnQiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvclZpc2libGVDbGFzcyIsImVycm9yU2VsZWN0b3IiLCJpbnB1dEVycm9yU2VsZWN0b3IiLCJyZXBsYWNlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9tYWtlU3VibWl0QnV0dG9uQWN0aXZlIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVkIiwiU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVyZXJDYWxsYmFjayIsIl9jb250YWluZXJFbGVtZW50IiwiX3JlbmRlcmVyQ2FsbGJhY2siLCJpdGVtc0xpc3QiLCJpdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJhcHBlbmQiLCJVc2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImFib3V0U2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsInVuZGVmaW5lZCIsIl9uYW1lRWxlbWVudCIsIl9hYm91dEVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsImZvcm1TZWxlY3RvciIsImFwaSIsImNhcmRzQ29udGFpbmVyIiwiY2FyZERhdGEiLCJhZGRFbGVtZW50TGFzdCIsImNyZWF0ZUNhcmQiLCJkaWFsb2d1ZUNhcmRBZGQiLCJzZXRMb2FkaW5nU3RhdGUiLCJhZGRDYXJkIiwidGl0bGUiLCJpbWFnZSIsImFkZEVsZW1lbnRGaXJzdCIsImNhdGNoIiwiaGFuZGxlU2VydmVyRXJyb3IiLCJmaW5hbGx5IiwiZGlhbG9ndWVDYXJkUmVtb3ZlIiwiZGlhbG9ndWVDYXJkVmlldyIsImRpYWxvZ3VlUHJvZmlsZUNoYW5nZVBpY3R1cmUiLCJ1cGRhdGVVc2VyQXZhdGFyIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsImRpYWxvZ3VlUHJvZmlsZUVkaXQiLCJ1cGRhdGVVc2VySW5mbyIsImVycm9yIiwic2V0VGltZW91dCIsImNvbnNvbGUiLCJjYXJkIiwib3BlbiIsImNhcmRJZCIsImlzTGlrZWQiLCJkaXNsaWtlQ2FyZCIsImxpa2VDYXJkIiwiZGVsZXRlQ2FyZCIsInJlbW92ZUVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImdlbmVyYXRlRWxlbWVudCIsInNldElucHV0VmFsdWVzIiwiYWxsIiwiZ2V0QWxsQ2FyZHMiLCJyZW5kZXJJdGVtcyIsImVuYWJsZVZhbGlkYXRpb24iXSwic291cmNlUm9vdCI6IiJ9